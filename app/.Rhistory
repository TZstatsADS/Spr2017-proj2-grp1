KMO(tdata)
plot(scores[,1], scores[,2], type = "n", xlab = "Factor 1", ylab = "Factor 2")
fa3a <- factanal(data3, factors = 4, method ="mle", rotation="varimax", scores="regression")
data3<-read.csv("/Users/xuehan/Desktop/STAT407/HW/HW4/EUworkforce.csv", row.names=1)
cor3<-cor(data3)
fa3a <- factanal(data3, factors = 4, method ="mle", rotation="varimax", scores="regression")
scores <- fa3a$scores
plot(scores[,1], scores[,2], type = "n", xlab = "Factor 1", ylab = "Factor 2")
text(scores[,1], scores[,2], abbreviate(rownames(data3), 3), cex = 0.8)
HoustonMap <- qmap("houston", zoom = 14, color = "bw", legend = "topleft")
HoustonMap
library(ggmap)
library(ggplot2)
str(crime)
violent_crimes <- subset(crime,offense != "auto theft" & offense != "theft" & offense != "burglary")
violent_crimes$offense <- factor(violent_crimes$offense,levels = c("robbery", "aggravated assault", "rape", "murder"))
violent_crimes <- subset(violent_crimes,-95.39681 <= lon & lon <= -95.34188 &29.73631 <= lat & lat <= 29.78400)
head(violent_crimes[,c(5,16,17)])
library(ggplot2)
library(ggmap)
violent_crimes <- subset(crime,offense != "auto theft" & offense != "theft" & offense != "burglary")
violent_crimes$offense <- factor(violent_crimes$offense,levels = c("robbery", "aggravated assault", "rape", "murder"))
violent_crimes <- subset(violent_crimes,-95.39681 <= lon & lon <= -95.34188 &29.73631 <= lat & lat <= 29.78400)
head(violent_crimes[,c(5,16,17)])
HoustonMap <- qmap("houston", zoom = 14, color = "bw", legend = "topleft")
HoustonMap
HoustonMap <- qmap("houston", zoom = 14, color = "color", legend = "topleft")
HoustonMap
HoustonMap + geom_point(aes(x = lon, y = lat, colour = offense, size = offense),data=violent_crimes)
HoustonMap + geom_point(aes(x = lon, y = lat, color = offense, size = offense),data=violent_crimes)
HoustonMap + stat_bin2d(aes(x = lon, y = lat, color = offense, fill = offense),size = .5, bins = 30, alpha = 1/2,data = violent_crimes)
HoustonMap + stat_bin2d(aes(x = lon, y = lat, color = offense, fill = offense),size = .5, alpha = 1/2,data = violent_crimes)
HoustonMap <- qmap("houston", zoom = 14, color = "bw", legend = "topleft")
HoustonMap + stat_bin2d(aes(x = lon, y = lat, color = offense, fill = offense),size = .5, alpha = 1/2,data = violent_crimes)
HoustonMap + stat_bin2d(aes(x = lon, y = lat, color = offense, fill = offense),size = .5, bins=30, alpha = 1/2,data = violent_crimes)
HoustonMap + stat_bin2d(aes(x = lon, y = lat, color = offense, fill = offense),size = .5, alpha = 1/2,data = violent_crimes)
HoustonMap + stat_bin2d(aes(x = lon, y = lat, color = offense, fill = offense),size = .5, bins=30, alpha = 1/2,data = violent_crimes)
crimes <- subset(crime,offense != "auto theft" & offense != "theft" & offense != "burglary")
library(ggmap)
head(violent_crimes[,c(5,16,17)])
library(ggplot2)
library(mapproj)
violent_crimes <- subset(crime,offense != "auto theft" & offense != "theft" & offense != "burglary")
violent_crimes$offense <- factor(violent_crimes$offense,levels = c("robbery", "aggravated assault", "rape", "murder"))
violent_crimes <- subset(violent_crimes,-95.39681 <= lon & lon <= -95.34188 &29.73631 <= lat & lat <= 29.78400)
library(maps)
states.sex.stats <- read.csv("http://heike.github.io/R-workshops/02a-r-graphics/data/states.sex.stats.csv")
# extract data on the state level from the maps package data
states <- map_data("state")
head(states)
qplot(long, lat, geom="point", data=states)
qplot(long, lat, geom="polygon", data=states, group=group, colour=I("white")) + coord_map()
head(states.sex.stats)
states.sex.map <- merge(states, states.sex.stats, by.x="region", by.y="state.name", all.x=T)
qplot(long, lat, geom="polygon", data=states.sex.map, group=group, fill=avg.drnk) +
coord_map() + facet_grid(sex ~ .)
qplot(long, lat, geom="polygon", data=states.sex.map, group=group, fill=avg.drnk) +
coord_map() + facet_grid(sex ~ .) +   theme_bw() +
scale_fill_gradient2(limits=c(1.5, 4),low="lightgray",high="red") +
theme(axis.ticks = element_blank(),axis.text.x = element_blank(), axis.title.x=element_blank(),
axis.text.y = element_blank(), axis.title.y=element_blank()) +
ggtitle("Map of Average Number of Alcoholic Beverages Consumed Per Day by State and Gender")
library(ggmap)
head(violent_crimes[,c(5,16,17)])
violent_crimes <- subset(crime,offense != "auto theft" & offense != "theft" & offense != "burglary")
violent_crimes$offense <- factor(violent_crimes$offense,levels = c("robbery", "aggravated assault", "rape", "murder"))
violent_crimes <- subset(violent_crimes,-95.39681 <= lon & lon <= -95.34188 &29.73631 <= lat & lat <= 29.78400)
head(violent_crimes[,c(5,16,17)])
HoustonMap <- qmap("houston", zoom = 14, color = "bw", legend = "topleft")
HoustonMap
HoustonMap + geom_point(aes(x = lon, y = lat, color = offense, size = offense),data=violent_crimes)
library(maps)
states.sex.stats <- read.csv("http://heike.github.io/R-workshops/02a-r-graphics/data/states.sex.stats.csv")
states <- map_data("state")
states
head(states)
qplot(long, lat, geom="point", data=states)
qplot(long, lat, geom="polygon", data=states, group=group, colour=I("white")) + coord_map()
head(states.sex.stats)
states.sex.map <- merge(states, states.sex.stats, by.x="region", by.y="state.name", all.x=T)
qplot(long, lat, geom="polygon", data=states.sex.map, group=group, fill=avg.drnk) +
coord_map() + facet_grid(sex ~ .)
qplot(long, lat, geom="polygon", data=states.sex.map, group=group, fill=avg.drnk) +
coord_map() + facet_grid(sex ~ .) +   theme_bw() +
scale_fill_gradient2(limits=c(1.5, 4),low="lightgray",high="red") +
theme(axis.ticks = element_blank(),axis.text.x = element_blank(), axis.title.x=element_blank(),
axis.text.y = element_blank(), axis.title.y=element_blank()) +
ggtitle("Map of Average Number of Alcoholic Beverages Consumed Per Day by State and Gender")
library(ggmap)
head(violent_crimes[,c(5,16,17)])
HoustonMap <- qmap("houston", zoom = 14, color = "bw", legend = "topleft")
HoustonMap
HoustonMap + geom_point(aes(x = lon, y = lat, color = offense, size = offense),data=violent_crimes)
HoustonMap + stat_bin2d(aes(x = lon, y = lat, color = offense, fill = offense),size = .5, alpha = 1/2,data = violent_crimes)
```
HoustonMap + geom_point(aes(x = lon, y = lat, color = offense, size = offense),data=violent_crimes)
library(ggplot2)
library(mapproj)
library(ggplot2)
violent_crimes <- subset(crime,offense != "auto theft" & offense != "theft" & offense != "burglary")
violent_crimes$offense <- factor(violent_crimes$offense,levels = c("robbery", "aggravated assault", "rape", "murder"))
violent_crimes <- subset(violent_crimes,-95.39681 <= lon & lon <= -95.34188 &29.73631 <= lat & lat <= 29.78400)
head(violent_crimes[,c(5,16,17)])
library(ggmap)
violent_crimes <- subset(crime,offense != "auto theft" & offense != "theft" & offense != "burglary")
violent_crimes$offense <- factor(violent_crimes$offense,levels = c("robbery", "aggravated assault", "rape", "murder"))
violent_crimes <- subset(violent_crimes,-95.39681 <= lon & lon <= -95.34188 &29.73631 <= lat & lat <= 29.78400)
head(violent_crimes[,c(5,16,17)])
library(maps)
states.sex.stats <- read.csv("http://heike.github.io/R-workshops/02a-r-graphics/data/states.sex.stats.csv")
states <- map_data("state")
head(states)
qplot(long, lat, geom="point", data=states)
qplot(long, lat, geom="polygon", data=states, group=group, colour=I("white")) + coord_map()
head(states.sex.stats)
states.sex.map <- merge(states, states.sex.stats, by.x="region", by.y="state.name", all.x=T)
states.sex.map <- merge(states, states.sex.stats, by.x="region", by.y="state.name", all.x=T)
qplot(long, lat, geom="polygon", data=states.sex.map, group=group, fill=avg.drnk) +
coord_map() + facet_grid(sex ~ .)
qplot(long, lat, geom="polygon", data=states.sex.map, group=group, fill=avg.drnk) +
coord_map() + facet_grid(sex ~ .) +   theme_bw() +
scale_fill_gradient2(limits=c(1.5, 4),low="lightgray",high="red") +
theme(axis.ticks = element_blank(),axis.text.x = element_blank(), axis.title.x=element_blank(),
axis.text.y = element_blank(), axis.title.y=element_blank()) +
ggtitle("Map of Average Number of Alcoholic Beverages Consumed Per Day by State and Gender")
library(ggmap)
head(violent_crimes[,c(5,16,17)])
HoustonMap <- qmap("houston", zoom = 14, color = "bw", legend = "topleft")
HoustonMap
HoustonMap + geom_point(aes(x = lon, y = lat, color = offense, size = offense),data=violent_crimes)
HoustonMap + stat_bin2d(aes(x = lon, y = lat, color = offense, fill = offense),size = .5, alpha = 1/2,data = violent_crimes)
library(maps)
states.sex.stats <- read.csv("http://heike.github.io/R-workshops/02a-r-graphics/data/states.sex.stats.csv")
states <- map_data("state")
head(states)
qplot(long, lat, geom="point", data=states)
qplot(long, lat, geom="polygon", data=states, group=group, colour=I("white")) + coord_map()
head(states.sex.stats)
states.sex.map <- merge(states, states.sex.stats, by.x="region", by.y="state.name", all.x=T)
qplot(long, lat, geom="polygon", data=states.sex.map, group=group, fill=avg.drnk) +
coord_map() + facet_grid(sex ~ .)
qplot(long, lat, geom="polygon", data=states.sex.map, group=group, fill=avg.drnk) +
coord_map() + facet_grid(sex ~ .) +   theme_bw() +
scale_fill_gradient2(limits=c(1.5, 4),low="lightgray",high="red") +
theme(axis.ticks = element_blank(),axis.text.x = element_blank(), axis.title.x=element_blank(),
axis.text.y = element_blank(), axis.title.y=element_blank()) +
ggtitle("Map of Average Number of Alcoholic Beverages Consumed Per Day by State and Gender")
library(ggmap)
head(violent_crimes[,c(5,16,17)])
HoustonMap <- qmap("houston", zoom = 14, color = "bw", legend = "topleft")
HoustonMap
HoustonMap + geom_point(aes(x = lon, y = lat, color = offense, size = offense),data=violent_crimes)
HoustonMap + stat_bin2d(aes(x = lon, y = lat, color = offense, fill = offense),size = .5, alpha = 1/2,data = violent_crimes)
library(ggplot2)
library(ggmap)
violent_crimes <- subset(crime,offense != "auto theft" & offense != "theft" & offense != "burglary")
violent_crimes$offense <- factor(violent_crimes$offense,levels = c("robbery", "aggravated assault", "rape", "murder"))
violent_crimes <- subset(violent_crimes,-95.39681 <= lon & lon <= -95.34188 &29.73631 <= lat & lat <= 29.78400)
library(ggplot2)
library(mapproj)
library(ggplot2)
library(ggmap)
violent_crimes <- subset(crime,offense != "auto theft" & offense != "theft" & offense != "burglary")
violent_crimes$offense <- factor(violent_crimes$offense,levels = c("robbery", "aggravated assault", "rape", "murder"))
violent_crimes <- subset(violent_crimes,-95.39681 <= lon & lon <= -95.34188 &29.73631 <= lat & lat <= 29.78400)
library(ggplot2)
library(mapproj)
library(maps)
states.sex.stats <- read.csv("http://heike.github.io/R-workshops/02a-r-graphics/data/states.sex.stats.csv")
states <- map_data("state")
head(states)
qplot(long, lat, geom="point", data=states)
qplot(long, lat, geom="polygon", data=states, group=group, colour=I("white")) + coord_map()
head(states.sex.stats)
states.sex.map <- merge(states, states.sex.stats, by.x="region", by.y="state.name", all.x=T)
qplot(long, lat, geom="polygon", data=states.sex.map, group=group, fill=avg.drnk) +
coord_map() + facet_grid(sex ~ .)
qplot(long, lat, geom="polygon", data=states.sex.map, group=group, fill=avg.drnk) +
coord_map() + facet_grid(sex ~ .) +   theme_bw() +
scale_fill_gradient2(limits=c(1.5, 4),low="lightgray",high="red") +
theme(axis.ticks = element_blank(),axis.text.x = element_blank(), axis.title.x=element_blank(),
axis.text.y = element_blank(), axis.title.y=element_blank()) +
ggtitle("Map of Average Number of Alcoholic Beverages Consumed Per Day by State and Gender")
library(ggmap)
head(violent_crimes[,c(5,16,17)])
HoustonMap <- qmap("houston", zoom = 14, color = "bw", legend = "topleft")
HoustonMap
HoustonMap + geom_point(aes(x = lon, y = lat, color = offense, size = offense),data=violent_crimes)
HoustonMap + stat_bin2d(aes(x = lon, y = lat, color = offense, fill = offense),size = .5, alpha = 1/2,data = violent_crimes)
library(Sleuth3)
data1<-read.csv("/Users/xuehan/Desktop/STAT510/HW/HW2/case0501.csv")
head(data1)
boxplot(Lifetime~Diet,data=data1,xlab="Diet", ylab="Lifetime",main="Side-by-side Boxplots of Lifetime vs. Diet")
fullmodel<-aov(Lifetime~Diet,data=data1)
summary(fullmodel)
data1$Diet[data1$Diet == "R/R50"] <- "N/R50"
reduced<-aov(Lifetime~Diet,data=data1)
summary(reduced)
dim(data1)
x1<-rep(1:6,c(49,57,56,71,56,60))
X1=model.matrix(~0+factor(x1))
X1
x0<-rep(1:5,c(49,57,56,127,60))
X0=model.matrix(~0+factor(x0))
X0
library(MASS)
proj<-function(x){
x%*%ginv(t(x)%*%x)%*%t(x)
}
PX0=proj(X0)
PX=proj(X1)
FSTAT=(t(data1$Lifetime)%*%(PX-PX0)%*%data1$Lifetime/1)/(t(data1$Lifetime)%*%(diag(rep(1,349))-PX)%*%data1$Lifetime/(349-6))
FSTAT
pvalue<-1-pf(FSTAT,1,343)
pvalue
42.2971831-42.88571429
c<-matrix(c(0,0,0,1,-1,0),ncol=6,byrow=T)
c
c%*%(t(x)%*%x)%*%t(c)
x<-matrix(c(1,-1,0,0,0,0,0,1,-1,0,0,1,0,0,-1,1,0,0,0,-1),byrow=T,ncol=5)
x
c%*%(t(x)%*%x)%*%t(c)
t(x)
xtx<-t(x)%*%x
c%*%(xtx)%*%t(c)
X0
x<-matrix(c(1,-1,0,0,0,0,0,1,-1,0,0,1,0,0,-1,1,0,0,0,-1),byrow=T,ncol=5)
X
x
i<-ginv(xtx)
i
X1
c<-matrix(c(0,0,0,1,-1,0),ncol=6,byrow=T)
c
i<-ginv(t(X1)%*%X1)
c%*%it(c)
c%*%i%*%t(c)
1/c%*%i%*%t(c)
1/(c%*%i%*%t(c))
1/0.03194165
(-0.5885312*(31.30709)*-0.5885312)/1/44.59767
qr(c%*%i%*%t(c))
x1<-rep(1:6,c(49,57,56,71,56,60))
X1=model.matrix(~0+factor(x1))
c<-matrix(c(0,0,0,1,-1,0),ncol=6,byrow=T)
c
i<-ginv(t(X1)%*%X1)
1/(c%*%i%*%t(c))
library(MASS)
x1<-rep(1:6,c(49,57,56,71,56,60))
X1=model.matrix(~0+factor(x1))
c<-matrix(c(0,0,0,1,-1,0),ncol=6,byrow=T)
c
i<-ginv(t(X1)%*%X1)
1/(c%*%i%*%t(c))
??RTseris
inventory<-read.csv("/Users/xuehan/Desktop/STAT451/HW2/ChangeInventory.csv")
head(inventory)
plot(inventory$change~inventory$time,xlab="Time",ylab="Change in Inventory",main="Change in Bussiness Inventories in billions of Dollars")
abline(h=mean(inventory$change),col="red")
abline(h=10.73013,col="green")
abline(h=1.539873,col="green")
abline(h=15.32525,col="blue")
abline(h=-3.055254,col="blue")
sd(inventory$change)
original<-read.csv("/Users/xuehan/Desktop/STAT451/HW2/orChangeInventory.csv")
head(original)
plot((4.4,5.8),(5.8,6.7))
plot((4.4,5.8) (5.8,6.7))
inventory<-read.csv("/Users/xuehan/Desktop/STAT451/HW2/ChangeInventory.csv")
head(inventory)
plot(inventory$obs~inventory$obs1)
plot(inventory$obs1~inventory$obs)
plot(inventory$obs1~inventory$obs,xlab="series",ylab="series lag1",main="Lag 1")
file.choose()
data<-read.csv("/Users/xuehan/Desktop/STAT510/HW/HW3/FabricLoss.csv")
head(data)
data
apply(data$y[1:2])
apply(data$y[1:2],mean)
apply(data$y[1:2, ],mean)
```
apply(data$y[1:2, ],mean)
(194+208)/2
x<-c(194,208)
mean(x)
sd(x)
((194+208)/2+(233+241)/2+(265+269)/2+(155+173)/2+(198+177)/2+(235+229)/2)/6
(194+208)/2+(233+241)/2+(265+269)/2+(155+173)/2+(198+177)/2+(235+229)/2
1288.5/6
((239+187)/2+(224+243)/2+(243+226)/2+(137+160)/2+(129+98)/2+(155+132)/2)/6
[(233+241)/2+(224+243)/2]/2
((233+241)/2+(224+243)/2)/2
y<-c((233+241)/2,(224+243)/2)
y
sd(y)
data
data$surface<-factor(data$surface)
data$filler<-factor(data$filler)
data$p<-factor(data$p)
data
o<-lm(y~filter+surface+p,data=data)
o<-lm(y~filler+surface+p,data=data)
model.matrix(o)
coef(o)
vcov(o)
estimate=function(lmout,C,a=0.05)
{
b=coef(lmout)
V=vcov(lmout)
df=lmout$df
Cb=C%*%b
se=sqrt(diag(C%*%V%*%t(C)))
tval=qt(1-a/2,df)
low=Cb-tval*se
up=Cb+tval*se
m=cbind(C,Cb,se,low,up)
dimnames(m)[[2]]=c(paste("c",1:ncol(C),sep=""),
"estimate","se",
paste(100*(1-a),"% Conf.",sep=""),
"limits")
m
}
test=function(lmout,C,d=0){
b=coef(lmout)
V=vcov(lmout)
dfn=nrow(C)
dfd=lmout$df
Cb.d=C%*%b-d
Fstat=drop(t(Cb.d)%*%solve(C%*%V%*%t(C))%*%Cb.d/dfn)
pvalue=1-pf(Fstat,dfn,dfd)
list(Fstat=Fstat,pvalue=pvalue)
}
C=matrix(c(
0, 1, 0, 0,0
), nrow=1, byrow=T)
C=matrix(c(0, 1, 0, 0,0), nrow=1, byrow=T)
C
test(o,C)
o<-lm(y~filler+surface+p,data=data)
C=matrix(c(0, 1, 0, 0,0), nrow=1, byrow=T)
C
test(o,C)
omean<-lm(y~0+filler+surface+p,data=data)
model.matrix(omean)
omean<-lm(y~0+filler:surface:p,data=data)
model.matrix(omean)
coef(omean)
test=function(lmout,C,d=0){
b=coef(lmout)
V=vcov(lmout)
dfn=nrow(C)
dfd=lmout$df
Cb.d=C%*%b-d
Fstat=drop(t(Cb.d)%*%solve(C%*%V%*%t(C))%*%Cb.d/dfn)
pvalue=1-pf(Fstat,dfn,dfd)
list(Fstat=Fstat,pvalue=pvalue)
}
Cmean=matrix(c(1,-1,-1,1,-1,1,1,-1), nrow=1, byrow=T)
Cmean
test(omean,Cmean)
Cmean=matrix(c(1,-1,-1,1,-1,1,1,-1,0,0,0,0), nrow=1, byrow=T)
Cmean
test(omean,Cmean)
Cmean=matrix(c(1,-1,-1,1,-1,1,1,-1,-1,-1,1,1), nrow=1, byrow=T)
Cmean
test(omean,Cmean)
Cmean=matrix(c(0.5,-0.5,0.5,-0.5,-0.5,0.5,-0.5,0.5,-0.5,0.5,-0.5,0.5), nrow=1, byrow=T)
Cmean
test(omean,Cmean)
x = matrix ( rep( c( 10, 20, 30,40,50),each=3), dimnames=list(1:15,"density"))
yield <- matrix( c( 12.2 , 11.4 , 12.4 , 16 , 15.5 , 16.5, 18.6,
20.2, 18.2, 17.6, 19.3, 17.1, 18, 16.4, 16.6), dimnames=list(1:15,"yield") )
d <- as.data.frame(cbind( x, yield))
#x=(x-mean(x))/10
n=nrow(d)
x1 = matrix(1,nrow=n,ncol=1)
x2 = cbind(x1,x)
x3 = cbind(x2,x^2)
x4 = cbind(x3,x^3)
x5 = matrix(model.matrix(~0+factor(x)),nrow=n)
I  = diag(rep(1,n))
library(MASS)
proj=function(x){
x%*%ginv(t(x)%*%x)%*%t(x)}
p1=proj(x1)
p2=proj(x2)
p3=proj(x3)
p4=proj(x4)
p5=proj(x5)
X=x5
(p2-p1)%*%X
(p3-p2)%*%X
(p4-p3)%*%X
(p5-p4)%*%X
c1 <- 10*((p2-p1)%*%X)[1,]
c2 <-    ((p3-p2)%*%X)[1,]
c3 <-    ((p4-p3)%*%X)[1,]
c4 <-    ((p5-p4)%*%X)[1,]
c1
c2```
c2
c3
c4
c1
c2
c3
c4
x2
x1<-matrix(c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1),ncol=1,byrow=F)
x1
x2<-matrix(c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,-2,-2,-2,-1,-1,-1,0,0,0,1,1,1,2,2,2),ncol=2,byrow=F)
x2
x3 = cbind(x2,x^2)
x3
x4
x5
x5 = matrix(model.matrix(~0+factor(x)),nrow=n)
c1 <-(p2-p1)%*%X
c2 <-(p3-p2)%*%X
c3 <-(p4-p3)%*%X
c4 <-(p5-p4)%*%X
c1
c2
c3
c4
c1<-matrix(c(0.4，0.2，0，－0.2，－0.4),ncol=5,byrow=F)
c1
c1<-matrix(c(0.4,0.2,0,-0.2,-0.4),ncol=5,byrow=F)
c1
c2<-matrix(c(0.286, -0.143, -0.286, -0.143, 0.286),ncol=5,byrow=F)
c3<-matrix(c(-0.86, -0.184, 0.189, 0.216, -0.143),ncol=5,byrow=F)
c4<-matrix(c(0.975, -0.074, -0.103, -0.073, 0.057),ncol=5,byrow=F)
ginv(t(x5)%*%x5)
x5 = matrix(model.matrix(~0+factor(x)),nrow=n)
ginv(t(x5)%*%x5)
c1%*%ginv(t(x5)%*%x5)%*%t(c2)
c1%*%ginv(t(x5)%*%x5)%*%t(c3)
c1%*%ginv(t(x5)%*%x5)%*%t(c4)
c2%*%ginv(t(x5)%*%x5)%*%t(c3)
c2%*%ginv(t(x5)%*%x5)%*%t(c4)
c3%*%ginv(t(x5)%*%x5)%*%t(c3)
spam <- read.table("spam.data.txt", header = FALSE, sep = " ")
names(spam) <- c("make","address","all","3d","our","over","remove","internet","order","mail","receive","will","people",
"report","addresses","free","business","email","you","credit","your","font","000","money","hp",
"hpl","george","650","lab","labs","telnet","857","data","415","85","technology","1999","parts",
"pm","direct","cs","meeting","original","project","re","edu","table","conference",";","(","[","!",
"$","#","capital_run_length_average","capital_run_length_longest","capital_run_length_total", "label")
createComboHeatMap("Clinton",borough="Manhattan", wifiData, taxiData, "blue", "red")
library(choroplethr)
library(choroplethrZip)
library(dplyr)
library(raster)
library(rgeos)
library(ggmap)
library(ggplot2)
source("../doc/identifyNeighborhoodsAndBoroughs.R")
file.choose()
setwd("/Users/xuehan/Desktop/Spr2017-proj2-grp1/")
source("../doc/identifyNeighborhoodsAndBoroughs.R")
setwd("/Users/xuehan/Desktop/Spr2017-proj2-grp1")
source("../doc/identifyNeighborhoodsAndBoroughs.R")
setwd("/Users/xuehan/Desktop/Spr2017-proj2-grp1/")
shiny::runApp('app')
setwd("~/Desktop/Spr2017-proj2-grp1/app")
runApp()
shiny::runApp()
runApp()
library(choroplethr)
library(choroplethrZip)
library(dplyr)
library(raster)
library(rgeos)
library(ggmap)
library(ggplot2)
source("../doc/identifyNeighborhoodsAndBoroughs.R")
nycShapeFile <- shapefile("../data/nynta_16d/nynta.shp")
source("../doc/createHeatMap.R")
data1 <- read.csv("../data/Free_WiFi_Hotspots_09042005.csv", header=TRUE)
data2 <- read.csv("../data/LinkNYC_Locations.csv", header=TRUE)
data_c1 <- subset(data1, select=c(LON, LAT, SSID))
data_c2 <- subset(data2, select=c(Longitude, Latitude, CB.Link.ID))
colnames(data_c1) <- colnames(data_c2) <- c("LON", "LAT","network")
data <- read.csv("../data/yellow_tripdata_2016-02.csv", header = T)
pts <- as.data.frame(cbind(data$pickup_longitude, data$pickup_latitude, data$tpep_pickup_datetime))
colnames(pts) <- c("LON", "LAT", "TIME")
pts2 <- as.data.frame(cbind(data$dropoff_longitude, data$dropoff_latitude, data$tpep_dropoff_datetime))
colnames(pts2) <- c("LON", "LAT", "TIME")
pts3 <- as.data.frame(rbind(pts,pts2))
pts3$LON <- as.numeric(as.character(pts3$LON))
pts3$LAT <- as.numeric(as.character(pts3$LAT))
pts4 <- pts3[(pts3$LAT != 0) & (pts3$LON != 0),]
pts5 <- pts4[(pts4$LAT >= 38) & (pts4$LAT <= 44) & (pts4$LON <= -72) & (pts4$LON >= -76),]
pts6 <- pts5[1:500000,]
nycShapeFile <- shapefile("../data/nynta_16d/nynta.shp")
source("../doc/identifyNeighborhoodsAndBoroughs.R")
taxiData <- identifyNeighborhoodsAndBoroughs(pts6, nycShapeFile)
yelpData <- read.csv("../output/yelpdata.csv", header=TRUE)
yelpData <- subset(yelpData, select=-c(X))
wifiData <- as.data.frame(rbind(data_c1, data_c2, yelpData))
wifiData <- identifyNeighborhoodsAndBoroughs(wifiData, nycShapeFile)
wifiData <- subset(wifiData, select=-c(network))
taxiData <- subset(taxiData, select=-c(TIME))
getneighborhood<- function(df) {
r <- unique(df$neighborhood)
r <- r[order(r)]
return(r)}
wifi <- dlply(wifiData, .(borough), getneighborhood)
taxi <- dlply(taxiData, .(borough), getneighborhood)
createComboHeatMap("Clinton",borough="Manhattan", wifiData, taxiData, "blue", "red")
runApp()
runApp()
